---
id: 2019-05-13-Pic_bed.md
author: Anon
layout: post
title: 自建图床
date: 2019/5/13
categories: 生产环境
tags: GoodSync SSH
description: 综合考虑对象存储服务、图床服务后，我选择了自建图床。
---


* content
{:toc}

随着文章的数目变多，博客的加载速度变得越来越慢尤其是主页需要显示每篇文章开头被截取到的图片的时候。所以，是时候考虑一下图床的问题了。

___



## 背景

在此之前，我其实一直都是在~~“蹭”~~Github的存储功能——自建了一个专门用于存放静态资源的仓库，每次都通过`Download`按钮获取外链。

<div style="text-align: center;"><img style="height:600px;" alt="" title="" src="http://ss.showyoumycode.com/StaticData/Blog/IntroPicBed/Github_picbed.png"></div>

一开始的时候效果不错，毕竟不需要付费。但是还是有很多直接暴露出来的问题，比如是否违反用户协定（~~虽然管理员好像有声明过这并不属于abuse，并且官方也提供Download按钮~~），速度慢，[RawGit](https://rawgit.com/)今年十月将停止服务。

不过这些都不是真正的问题，真正的问题是：如果基于**Repo**的存储必须持有整个仓库才能进行数据的维护而如果基于**Issue**的存储则难以实现不同静态文件对应不同文件夹的管理，并且可能会涉及abuse问题。

## 环境

在选择并实施新的解决方案之前，首先需要分析一下我自己的（博客）生产环境以及对图床服务的相关需求。

- 主要在PC上处理图片素材，PC大概一个月关机一次。
- 在PC上书写博客较多，在MBP上一般书写的是即兴突然来灵感之类的内容。两者有上传图片的需求，MBP上的图片主要是引用外部资源。

对于图床服务（其实我更愿意描述成**静态文件存储服务**），我的需求或许会严格一些。

- 服务可以挂，**数据不能丢**，丢了写的所有的文章都报废。 
- 服务重置后，文章中的**引用链接**尽可能的不要变化。（静态资源外链的值需要是**可以被预期的**，甚至可以被设置的。这样最大的好处就在于，当服务重置时上传新的文件数据不需要建立新的映射关系。）
- 服务尽可能的不要关联到其他操作如域名备案。
- 服务不容易挂。
- 价格越低越好。
- 速度越快越好。

## 相关服务分析

大体上要实现静态文件存储并提供外链主要有那么几种选择：“蹭“一些大体量的社交软件及相关相册程序、纯粹的图床服务、对象存储（云）服务、基于（实体、云、虚拟）主机自建图床。

#### 社交软件

如微博（针对外链启用了相关屏蔽），[imgur](https://imgur.com/)等。

最大好处就是**快，它比你更想让数据更快地输出到用户的浏览器中**且**免费**和**良好的抗攻击性**，毕竟它是实际的为用户提供服务的应用程序。当然坏处也很明显：

- 服务本身的不稳定性（不影响数据）
  - 例如发布在微博的静态资源已经开启了防外链功能，你需要付出一定的成本（设置Http Header等），才能让它在如期显示在你的站点上。
- 数据本身的不安全性。



### 图床服务

